# Лабораторная работа №1
Установка ALT Linux на виртуальную машину VirtualBox с ручной разметкой диска

## Цель работы
1. Научиться устанавливать операционную систему ALT Linux в среде VirtualBox.
2. Отработать навыки создания и настройки виртуальных машин.
3. Освоить ручную разметку дискового пространства при установке ОС.
4. Научиться добавлять виртуальные диски и настраивать сетевые интерфейсы.

## 1. Подготовка необходимых ресурсов

### Что понадобится:
- Компьютер с установленной ОС Windows / Linux / macOS.
- Программа Oracle VirtualBox (версия не ниже 7.0).
- Образ дистрибутива ALT Linux (рекомендуется использовать ALT Workstation K или ALT Server).
- Скачать можно с официального сайта: https://www.altlinux.org/
- Файл: alt-workstation-k-*.iso (или alt-server-*.iso)

**Совет:** Сохраните образ в папку, например: C:\VMs\ISO\alt-linux.iso

## 2. Получение индивидуального варианта

Преподаватель выдаёт каждому студенту номер варианта от 1 до 35. По таблице ниже определите параметры своей виртуальной машины.

| № варианта | ОЗУ (MB) | vCPU | Размер основного диска (ГБ) | Доп. диск (ГБ) | Тип сети |
|------------|----------|------|-----------------------------|----------------|----------|
| 1–5        | 1024     | 1    | 15                          | 5              | NAT      |
| 6–10       | 2048     | 2    | 20                          | 10             | NAT      |
| 11–15      | 2048     | 2    | 25                          | 15             | NAT + Host-only |
| 16–20      | 4096     | 2    | 30                          | 20             | NAT + Host-only |
| 21–25      | 4096     | 4    | 35                          | 25             | NAT + Host-only |
| 26–30      | 8192     | 4    | 40                          | 30             | NAT + Host-only + Internal |
| 31–35      | 8192     | 6    | 50                          | 40             | NAT + Host-only + Internal |

**Примечание:**
- NAT — доступ в интернет из ВМ.
- Host-only — связь между хостом и ВМ.
- Internal — связь только между ВМ (для будущих лабораторных работ).

## 3. Создание виртуальной машины в VirtualBox

**Шаг 1.** Запустите VirtualBox → «Создать»
- Имя: ALT_Linux_ВашеИмя_ВариантX
- Тип: Linux
- Версия: Other Linux (64-bit)

**Шаг 2.** Укажите объём оперативной памяти (ОЗУ)
- Используйте значение из таблицы по вашему варианту.

**Шаг 3.** Создайте виртуальный жёсткий диск
- Выберите «Создать новый виртуальный жёсткий диск»
- Тип файла: VDI (VirtualBox Disk Image)
- Хранение: Динамически расширяемый
- Размер основного диска: как в таблице (например, 20 ГБ)

**Примечание:** После этого ВМ будет создана, но пока без дополнительного диска.

## 4. Добавление второго виртуального диска

1. Выделите созданную ВМ → нажмите «Настроить».
2. Перейдите в раздел «Носители».
3. В контроллере SATA найдите свободный порт (например, SATA Port 1).
4. Нажмите на значок диска → «Создать нового диска».
5. Тип: VDI
6. Размер: как указано в таблице (например, 10 ГБ)
7. Нажмите ОК.

**Иллюстрация:** окно "Носители" с двумя дисками — основным и дополнительным.

## 5. Настройка сетевых адаптеров

1. В том же окне «Настроить» → «Сеть».
2. Адаптер 1: включить, тип подключения — NAT.
3. Адаптер 2 (если требуется по варианту): включить → Только хост (Host-only Adapter).
4. Адаптер 3 (если требуется): включить → Внутренняя сеть (Internal Network), имя: labnet.

**Важно:** Убедитесь, что в VirtualBox есть хотя бы один Host-only адаптер (Файл → Настройки → Сеть → Вкладка Host-only).

## 6. Подключение ISO-образа ALT Linux

1. В настройках ВМ → «Носители».
2. В контроллере IDE (или SATA) выберите пустой привод.
3. Нажмите на значок диска → Выбрать диск → укажите путь к скачанному .iso файлу.
4. Нажмите ОК.

## 7. Запуск установки ALT Linux

1. Запустите ВМ.
2. При загрузке выберите «Install ALT Linux» (обычно первый пункт).
3. Дождитесь загрузки установщика.

## 8. Ручная разметка диска (ключевой этап!)

**Внимание:** автоматическая разметка не допускается — требуется ручная!

**Шаг 1.** В установщике перейдите к разделу «Разметка дисков» → выберите «Вручную».
**Шаг 2.** Выберите первый диск (обычно /dev/sda).
**Шаг 3.** Удалите все существующие разделы (если есть).

**Шаг 4.** Создайте разделы в соответствии с вашим вариантом:

### Группа 1: Варианты 1-10 (Стандартная схема)
| Тип раздела | Точка монтирования | Размер | Файловая система |
|-------------|---------------------|--------|------------------|
| primary     | /boot               | 512 МБ | ext4             |
| primary     | swap                | = ОЗУ  | swap             |
| primary     | /                   | остаток| ext4             |

### Группа 2: Варианты 11-20 (Схема с отдельным /home)
| Тип раздела | Точка монтирования | Размер | Файловая система |
|-------------|---------------------|--------|------------------|
| primary     | /boot               | 512 МБ | ext4             |
| primary     | swap                | = ОЗУ  | swap             |
| primary     | /                   | 20 ГБ  | ext4             |
| primary     | /home               | остаток| ext4             |

### Группа 3: Варианты 21-30 (Схема с системными разделами)
| Тип раздела | Точка монтирования | Размер | Файловая система |
|-------------|---------------------|--------|------------------|
| primary     | /boot               | 512 МБ | ext4             |
| primary     | swap                | = ОЗУ  | swap             |
| primary     | /                   | 15 ГБ  | ext4             |
| primary     | /var                | 10 ГБ  | ext4             |
| primary     | /tmp                | 5 ГБ   | ext4             |
| primary     | /home               | остаток| ext4             |

### Группа 4: Варианты 31-35 (Расширенная схема с отдельными разделами)
| Тип раздела | Точка монтирования | Размер | Файловая система |
|-------------|---------------------|--------|------------------|
| primary     | /boot               | 512 МБ | ext4             |
| primary     | swap                | = ОЗУ  | swap             |
| primary     | /                   | 20 ГБ  | ext4             |
| primary     | /var                | 15 ГБ  | ext4             |
| primary     | /usr                | 10 ГБ  | ext4             |
| primary     | /home               | остаток| ext4             |

**Примечание:** Для вариантов с большим объёмом ОЗУ (>4 ГБ) swap можно сделать фиксированным — 4 ГБ.

**Шаг 5.** Не трогайте второй диск (/dev/sdb) — он останется нетронутым (будет использован позже в других лабораторных работах).
**Шаг 6.** Подтвердите форматирование и продолжите установку.

## 9. Завершение установки

Укажите:
- Язык: Русский
- Раскладка: ru
- Часовой пояс: Europe/Moscow
- Пароль root
- Имя пользователя и пароль

Дождитесь окончания копирования файлов.
После завершения — перезагрузите систему.
Отключите ISO-образ (в настройках ВМ → носители → удалить ISO из привода), чтобы не загружаться снова с него.

## 10. Проверка работоспособности

### Проверка навыков работы с VirtualBox

Перед завершением работы выполните следующие действия в VirtualBox:
1. Создайте снимок состояния (snapshot) установленной системы с именем "Установка завершена"
2. Экспортируйте конфигурацию ВМ в OVA файл для резервной копии
3. Сделайте скриншот окна VirtualBox с информацией о текущем состоянии ВМ

### Диагностика системы в ALT Linux

После загрузки в ALT Linux выполните следующие команды для полной диагностики системы:

```bash
# Проверка разметки диска (используем parted вместо fdisk для ALT Linux)
parted -l

# Проверка файловой системы и использования диска
df -h

# Проверка использования памяти и swap
free -h

# Проверка активного swap
swapon --show

# Проверка сетевых интерфейсов
ip addr show

# Проверка маршрутизации
ip route show

# Проверка подключения к интернету
ping -c 4 8.8.8.8

# Проверка информации об установленной системе
cat /etc/os-release
uname -a

# Проверка загруженных модулей ядра
lsmod | head -10

# Проверка работающих процессов
ps aux | head -10
```

### Расширенная сетевая диагностика

```bash
# Проверка DNS разрешения
nslookup example.com

# Проверка сетевой связности с хостом
ping -c 4 192.168.56.1

# Проверка скорости сети (если доступен speedtest-cli)
speedtest-cli --simple
```

Убедитесь, что:
- Есть разделы /, /boot, swap (проверяется через `parted -l` и `lsblk`).
- Второй диск (/dev/sdb) не смонтирован и не содержит разделов.
- Интерфейс eth0 (или enp0s3) имеет IP-адрес (через NAT).
- При наличии Host-only — есть второй интерфейс с адресом вида 192.168.56.x.
- Система успешно пингует внешние адреса (проверка интернет-соединения).
- Информация об ОС отображается корректно (ALT Linux).
- DNS разрешение работает корректно.
- Сеть между хостом и ВМ функционирует.

## 11. Возможные ошибки и способы устранения

| Ошибка | Причина | Решение |
|--------|---------|---------|
| Не загружается установщик | Неправильный ISO или повреждённый файл | Проверьте контрольную сумму ISO; перекачайте |
| Черный экран после запуска | Проблемы с видеоадаптером | В настройках ВМ → Дисплей → Видеопамять 128 МБ, отключить 3D-ускорение |
| Нет интернета в ВМ | NAT не настроен или отключён | Проверьте: Адаптер 1 = NAT, включён |
| Не виден второй диск | Не добавлен в настройках ВМ | Вернитесь в «Настроить» → «Носители» → добавьте VDI |
| Ошибка при разметке: «Недостаточно места» | Неверно указан размер раздела | Убедитесь, что сумма разделов ≤ размеру диска |
| Система не грузится после установки | ISO не отключён | Отключите ISO в настройках ВМ перед перезагрузкой |

## Отчёт по лабораторной работе

Студент должен предоставить:
- Скриншоты:
  - Настройки ВМ (память, процессоры, диски, сеть)
  - Экран ручной разметки с вашими разделами (должны быть видны все разделы согласно вашему варианту)
  - Результаты команд `parted -l`, `df -h`, `free -h` и `ip addr show`
  - Проверка интернет-соединения (результат команды `ping -c 4 8.8.8.8`)
  - Снимок состояния (snapshot) в VirtualBox
  - Экспортированный OVA файл (скриншот процесса экспорта)
- Краткое описание:
  - Какой вариант выполняли и какую схему разметки использовали
  - С какими трудностями столкнулись и как решили (особенно при создании индивидуальной схемы разметки)
  - Анализ использования системных ресурсов (память, диск, сеть)
  - Выводы о работоспособности установленной системы
  - Результаты сетевой диагностики (DNS, связность с хостом)
  - Информация о загруженных модулях ядра и процессах
- Дополнительные материалы:
  - Файл с результатами всех диагностических команд (текстовый файл)
  - Краткое сравнение ожидаемых и фактических результатов
- Особенности для разных групп вариантов:
  - **Группа 1 (1-10)**: Анализ стандартной схемы разметки и ее преимуществ
  - **Группа 2 (11-20)**: Обоснование выделения отдельного /home раздела
  - **Группа 3 (21-30)**: Объяснение назначения системных разделов (/var, /tmp)
  - **Группа 4 (31-35)**: Обоснование выделения отдельных разделов /var и /usr, их назначение

## Дополнительно (для углублённого изучения)

1. Попробуйте вручную создать LVM на втором диске после установки.
2. Настройте статический IP в Host-only сети.
3. Установите пакет mc и nano через apt-get install.
